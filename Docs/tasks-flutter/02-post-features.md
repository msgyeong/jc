# 2단계: 게시글 관련 기능 구현

**기간**: 2일차 ~ 3일차  
**목표**: 게시글 목록/상세/작성 및 댓글/공감 기능 완성

> **선행 조건**: 
> - [ ] 1단계 완료 (인증 시스템 구축)

> **참고**: 
> - 게시글 작성은 모든 승인된 회원 가능
> - 수정/삭제는 작성자 또는 관리자만 가능
> - 이미지 첨부는 최대 5개까지 가능 (네이버 밴드 방식, 각각 500MB 이하)

> **역할 구분**: 
> - 🤖 **Cursor(AI)**: Cursor가 혼자 진행 가능한 작업
> - 👤 **사용자**: 사용자가 직접 해야 하는 작업 (테스트, 검증 등)

---

## 웹 앱(web/) 구현 현황

아래 항목은 **웹 앱(HTML/JS)** 기준으로 구현 완료되었습니다. (본문 체크리스트는 Flutter 앱 기준.)

### ✅ 완료
- [x] **게시판 목록**: 탭 전환 시 `loadPostsScreen()` 호출, 목록 로드, 무한 스크롤 (`web/js/posts.js`, `navigation.js`)
- [x] **게시글 카드**: 제목, 작성자, 작성일(상대시간), 미리보기, 댓글/공감 수, N 배지, 첫 이미지 썸네일
- [x] **게시글 작성**: 작성 화면(`#post-create-screen`), 제목/본문 필수 검증, API 연동(`POST /api/posts`), 등록 후 목록 갱신 및 게시판 복귀

### ⏳ 미구현(웹)
- [ ] 게시글 상세 화면
- [ ] 작성 시 이미지 첨부
- [ ] 게시글 수정/삭제
- [ ] 댓글/공감 UI

---

## 게시글 모델 및 서비스

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 게시글 모델 생성
- [ ] `lib/models/post_model.dart` 생성 (Freezed)
  - schema.sql의 posts 테이블 구조와 일치
  - `image_urls` 필드: `List<String>` (최대 5개)
  - `@JsonSerializable(fieldRename: FieldRename.snake)` 적용
- [ ] build_runner 실행

### [ ] 게시글 서비스
- [ ] `lib/services/post_service.dart` 생성
- [ ] 게시글 목록 조회 (페이지네이션)
- [ ] 게시글 상세 조회
- [ ] 게시글 작성/수정/삭제 (soft delete)

---

## 게시글 목록 화면

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 게시글 목록 UI
- [ ] `lib/screens/posts/post_list_screen.dart` 생성
- [ ] 게시글 리스트 (ListView.builder)
- [ ] 게시글 카드 위젯
  - 제목, 작성자, 작성일 (상대 시간)
  - 내용 미리보기 (최대 2줄)
  - 댓글 수, 공감 수
  - 'N' 배지 (새 게시글)
  - 첫 번째 이미지 썸네일
- [ ] 게시글 작성 버튼 (FAB)
- [ ] Pull-to-refresh
- [ ] 무한 스크롤 (페이지네이션)
- [ ] 빈 상태 메시지

### [ ] 게시글 목록 Provider
- [ ] `lib/providers/post_list_provider.dart` 생성
- [ ] AsyncNotifierProvider 사용
- [ ] 목록 로딩, 새로고침, 페이지네이션 처리

---

## 게시글 상세 화면

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 게시글 상세 UI
- [ ] `lib/screens/posts/post_detail_screen.dart` 생성
- [ ] 게시글 내용 표시
  - 제목, 작성자 정보, 작성일
  - 본문 내용
  - 첨부 이미지 갤러리 (최대 5개, 각각 500MB 이하)
- [ ] 공감 버튼 및 수
- [ ] 댓글 섹션
- [ ] 수정/삭제 버튼 (작성자 또는 관리자만)
- [ ] 이미지 뷰어 (전체 화면, 확대/축소, 스와이프)

### [ ] 게시글 상세 Provider
- [ ] `lib/providers/post_detail_provider.dart` 생성
- [ ] 게시글 상세 조회
- [ ] 읽음 상태 기록 (read_status 테이블)
- [ ] 공감 토글

---

## 게시글 작성 화면

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 게시글 작성 UI
- [ ] `lib/screens/posts/post_create_screen.dart` 생성
- [ ] 제목 입력 필드
- [ ] 본문 입력 필드 (여러 줄)
- [ ] 이미지 첨부 섹션 (**최대 5개까지 가능**, 네이버 밴드 방식)
  - 이미지 추가 버튼
  - 첨부된 이미지 미리보기 (그리드 레이아웃)
  - 이미지 삭제 버튼 (각 이미지별)
  - 이미지 순서 변경 (선택)
- [ ] 유효성 검증 (제목, 본문 필수)
- [ ] 오류 메시지 인라인 표시

### [ ] 게시글 작성 기능
- [ ] 이미지 업로드 (이미지 업로드 유틸리티 사용, **최대 5개까지, 각각 500MB 이하**)
- [ ] 이미지 다중 선택 UI (네이버 밴드 방식)
- [ ] 업로드 진행 표시 (각 이미지별 또는 전체)
- [ ] 게시글 작성 Provider
  - 게시글 저장
  - 이미지 URL 배열 저장 (image_urls TEXT[])
- [ ] 본문 최대 10MB 제한 확인

---

## 게시글 수정 화면

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 게시글 수정 UI
- [ ] `lib/screens/posts/post_edit_screen.dart` 생성
- [ ] 기존 내용 불러오기 (제목, 본문, 이미지)
- [ ] 제목/본문 수정 필드
- [ ] 이미지 수정 (추가/삭제/순서 변경)
- [ ] 수정 권한 확인 (작성자 또는 관리자)
- [ ] 수정 완료 버튼

### [ ] 게시글 수정 기능
- [ ] 게시글 수정 Provider
  - 기존 게시글 데이터 조회
  - 수정된 내용 저장
  - 이미지 추가/삭제 처리
- [ ] 수정 완료 후 상세 화면으로 이동

---

## 댓글 기능

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 댓글 모델 생성
- [ ] `lib/models/comment_model.dart` 생성 (Freezed)
  - Polymorphic 관계 (post_id, notice_id, schedule_id)
  - 대댓글 지원 (parent_comment_id)

### [ ] 댓글 서비스
- [ ] `lib/services/comment_service.dart` 생성
- [ ] 댓글 목록 조회
- [ ] 댓글 작성/수정/삭제 (soft delete)
- [ ] 대댓글 작성

### [ ] 댓글 Provider 및 UI
- [ ] `lib/providers/comment_provider.dart` 생성
- [ ] `lib/widgets/comment_item.dart` 생성
- [ ] 댓글 카드 (작성자, 내용, 작성일)
- [ ] 대댓글 표시 (들여쓰기)
- [ ] 댓글 작성 버튼
- [ ] 수정/삭제 버튼 (작성자만)

---

## 공감(좋아요) 기능

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 공감 기능 구현
- [ ] `lib/services/like_service.dart` 생성
- [ ] `lib/providers/like_provider.dart` 생성
- [ ] 공감 추가/제거
- [ ] 공감 여부 확인
- [ ] 공감 버튼 UI (하트 아이콘, 공감 수 표시)

---

## 'N' 배지 표시 (새 콘텐츠)

> **역할**: 🤖 **Cursor(AI)** 전담

### [ ] 새 콘텐츠 판단 로직
- [ ] 생성일로부터 3일 이내 확인
- [ ] 사용자 읽음 여부 확인 (read_status 테이블)
- [ ] 'N' 배지 UI (게시글 카드 우측 상단 또는 제목 옆)
- [ ] 강조 색상 사용

---

## 개발자 작업

> **역할**: 👤 **사용자** 전담

### [ ] 테스트 및 검증
- [ ] 게시글 목록 로딩 성능 테스트 (100개 이상)
- [ ] 게시글 작성 플로우 테스트
  - 텍스트만 작성
  - 이미지 1개 포함 작성
  - 이미지 5개까지 포함 작성
  - 이미지 선택/삭제/순서 변경 테스트
- [ ] 댓글/대댓글 작성 테스트
- [ ] 공감 기능 테스트
- [ ] 새 게시글 'N' 배지 표시 확인
- [ ] 읽음 상태 기록 확인 (다른 기기 동기화)
- [ ] comment_count, like_count 자동 업데이트 확인

---

## 완료 기준

- [x] **(웹)** 게시글 목록 정상 표시 및 무한 스크롤 작동
- [x] **(웹)** 게시글 작성 가능 (이미지 첨부는 추후 구현)
- [ ] 게시글 수정 가능 (작성자 또는 관리자)
- [ ] 게시글 삭제 가능 (작성자 또는 관리자)
- [ ] 댓글/대댓글 작성 가능
- [ ] 공감 기능 정상 작동 및 실시간 업데이트
- [ ] 새 게시글 'N' 배지 표시 및 읽은 후 제거
- [ ] 읽음 상태 기록 및 동기화

---

## 다음 단계
이 단계 완료 후 **03-notice-and-schedule.md**로 진행
