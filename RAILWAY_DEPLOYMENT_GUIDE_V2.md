# Railway ë°°í¬ ê°€ì´ë“œ

Railwayì— Node.js API + ì •ì  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ëŠ” ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸš€ ë°°í¬ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Railway ì»¨í…Œì´ë„ˆ                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Nginx       â”‚      â”‚  Node.js API    â”‚ â”‚
â”‚  â”‚  (:80)       â”‚â”€â”€â”€â”€â”€â–¶â”‚  (:3000)        â”‚ â”‚
â”‚  â”‚  /web/*      â”‚      â”‚  /api/*         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                      â”‚           â”‚
â”‚         â”‚                      â–¼           â”‚
â”‚         â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚         â”‚              â”‚ Railway         â”‚ â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ PostgreSQL      â”‚ â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ í•„ìˆ˜ í™˜ê²½ ë³€ìˆ˜

Railway ëŒ€ì‹œë³´ë“œì—ì„œ ë‹¤ìŒ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ì„¸ìš”:

```bash
# Railwayê°€ ìë™ìœ¼ë¡œ ì œê³µ (ìˆ˜ì •í•˜ì§€ ë§ˆì„¸ìš”)
DATABASE_URL=postgresql://...

# ì§ì ‘ ì¶”ê°€í•´ì•¼ í•˜ëŠ” í™˜ê²½ ë³€ìˆ˜
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters-long
NODE_ENV=production
```

### JWT_SECRET ìƒì„± ë°©ë²•

ì•ˆì „í•œ ëœë¤ ë¬¸ìì—´ ìƒì„±:

```bash
# Node.jsë¡œ ìƒì„±
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"

# OpenSSLë¡œ ìƒì„±
openssl rand -hex 32
```

## ğŸ”§ ë¡œì»¬ í…ŒìŠ¤íŠ¸

### 1. API ì„œë²„ ë‹¨ë… ì‹¤í–‰

```bash
cd api
npm install
node server.js
```

**í™•ì¸**: http://localhost:3000/health

### 2. ì›¹ + API í†µí•© í…ŒìŠ¤íŠ¸ (Docker)

```bash
# Docker ì´ë¯¸ì§€ ë¹Œë“œ
docker build -t jc-app .

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -p 8080:80 \
  -e DATABASE_URL="postgresql://..." \
  -e JWT_SECRET="test-secret-key" \
  jc-app
```

**í™•ì¸**:
- ì›¹: http://localhost:8080
- API: http://localhost:8080/api/health

## ğŸ“¦ Railway ë°°í¬

### ë°©ë²• 1: GitHub ì—°ë™ (ê¶Œì¥)

1. **GitHub ì €ì¥ì†Œì™€ ì—°ë™**
   - Railway ëŒ€ì‹œë³´ë“œ â†’ New Project â†’ Deploy from GitHub
   - ì €ì¥ì†Œ ì„ íƒ: `your-username/jc`

2. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   - Settings â†’ Variables
   - `JWT_SECRET` ì¶”ê°€
   - `DATABASE_URL`ì€ PostgreSQL ì„œë¹„ìŠ¤ ì—°ê²° ì‹œ ìë™ ì¶”ê°€

3. **ìë™ ë°°í¬**
   - `main` ë¸Œëœì¹˜ì— Push â†’ ìë™ ë¹Œë“œ ë° ë°°í¬

### ë°©ë²• 2: Railway CLI

```bash
# Railway CLI ì„¤ì¹˜
npm install -g @railway/cli

# ë¡œê·¸ì¸
railway login

# í”„ë¡œì íŠ¸ ì—°ê²°
railway link

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
railway variables set JWT_SECRET="your-secret-key"

# ë°°í¬
railway up
```

## ğŸ” ë°°í¬ í™•ì¸

### 1. ë°°í¬ ë¡œê·¸ í™•ì¸

Railway ëŒ€ì‹œë³´ë“œ â†’ Deployments â†’ ìµœì‹  ë°°í¬ ì„ íƒ â†’ View Logs

**ì„±ê³µ ë¡œê·¸ ì˜ˆì‹œ**:
```
ğŸš€ Railway ë°°í¬ ì‹œì‘
ğŸ“¡ í¬íŠ¸: 8080
ğŸŒ í™˜ê²½: production
âœ… Node.js API ì„œë²„ ì‹œì‘ë¨
âœ… API ì„œë²„ í—¬ìŠ¤ì²´í¬ í†µê³¼
âœ… ë°°í¬ ì™„ë£Œ!
```

### 2. ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸

**í—¬ìŠ¤ì²´í¬**:
```bash
curl https://your-app.railway.app/health
# ì‘ë‹µ: healthy

curl https://your-app.railway.app/api/health
# ì‘ë‹µ: {"status":"ok",...}
```

**API í…ŒìŠ¤íŠ¸**:
```bash
# ë¡œê·¸ì¸
curl -X POST https://your-app.railway.app/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"minsu@jc.com","password":"test1234"}'
```

**ì›¹ ì ‘ì†**:
- ë¸Œë¼ìš°ì €ì—ì„œ https://your-app.railway.app ì ‘ì†
- ë¡œê·¸ì¸ í™”ë©´ í™•ì¸
- í…ŒìŠ¤íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

## âš ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ: API ì„œë²„ê°€ ì‹œì‘ë˜ì§€ ì•ŠìŒ

**ì›ì¸**: `DATABASE_URL` ë˜ëŠ” `JWT_SECRET` ëˆ„ë½

**í•´ê²°**:
1. Railway ëŒ€ì‹œë³´ë“œ â†’ Settings â†’ Variables
2. í™˜ê²½ ë³€ìˆ˜ í™•ì¸
3. Redeploy

### ë¬¸ì œ: "502 Bad Gateway" ì—ëŸ¬

**ì›ì¸**: Node.js API ì„œë²„ê°€ ì¤€ë¹„ë˜ê¸° ì „ì— Nginxê°€ ìš”ì²­ì„ ì „ë‹¬

**í•´ê²°**:
- `start.sh`ì˜ `sleep 5` ì‹œê°„ì„ ëŠ˜ë¦¼ (ì˜ˆ: `sleep 10`)
- ë˜ëŠ” ì¬ë°°í¬ (ì¼ì‹œì  ë¬¸ì œì¼ ìˆ˜ ìˆìŒ)

### ë¬¸ì œ: CORS ì—ëŸ¬

**ì›ì¸**: Nginx CORS í—¤ë” ì„¤ì • ëˆ„ë½

**í•´ê²°**:
- `nginx.conf`ì— CORS í—¤ë”ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
- ì´ë¯¸ í¬í•¨ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ì¬ë°°í¬

### ë¬¸ì œ: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

**ì›ì¸**: Railway PostgreSQL ì„œë¹„ìŠ¤ ë¯¸ì—°ê²°

**í•´ê²°**:
1. Railway ëŒ€ì‹œë³´ë“œ â†’ í”„ë¡œì íŠ¸ ì„ íƒ
2. New â†’ Database â†’ Add PostgreSQL
3. ìë™ìœ¼ë¡œ `DATABASE_URL` í™˜ê²½ ë³€ìˆ˜ ì¶”ê°€ë¨
4. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”: `database/railway_init.sql` ì‹¤í–‰

## ğŸ“Š ëª¨ë‹ˆí„°ë§

### Railway ëŒ€ì‹œë³´ë“œ

- **Metrics**: CPU, ë©”ëª¨ë¦¬, ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ëŸ‰
- **Logs**: ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
- **Deployments**: ë°°í¬ íˆìŠ¤í† ë¦¬

### ë¡œê·¸ í™•ì¸ ëª…ë ¹ì–´

```bash
# Railway CLIë¡œ ë¡œê·¸ ë³´ê¸°
railway logs

# ì‹¤ì‹œê°„ ë¡œê·¸ ìŠ¤íŠ¸ë¦¬ë°
railway logs --follow
```

## ğŸ”„ ì—…ë°ì´íŠ¸ ë°°í¬

### ì½”ë“œ ë³€ê²½ í›„ ë°°í¬

```bash
# ë³€ê²½ ì‚¬í•­ ì»¤ë°‹
git add .
git commit -m "Update: ..."

# GitHubì— Push (ìë™ ë°°í¬)
git push origin main
```

### ê¸´ê¸‰ ë¡¤ë°±

```bash
# Railway CLIë¡œ ì´ì „ ë°°í¬ë¡œ ë¡¤ë°±
railway rollback
```

ë˜ëŠ” Railway ëŒ€ì‹œë³´ë“œì—ì„œ:
- Deployments â†’ ì´ì „ ë°°í¬ ì„ íƒ â†’ Redeploy

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°°í¬ ì „ í™•ì¸ ì‚¬í•­:

- [ ] `api/package.json` ì˜ì¡´ì„± í™•ì¸
- [ ] `DATABASE_URL` í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
- [ ] `JWT_SECRET` í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (32ì ì´ìƒ)
- [ ] `database/railway_init.sql` ì‹¤í–‰ ì™„ë£Œ
- [ ] í…ŒìŠ¤íŠ¸ ê³„ì • ìƒì„± (`create_test_member.sql`)
- [ ] ë¡œì»¬ Docker í…ŒìŠ¤íŠ¸ ì„±ê³µ
- [ ] GitHub ì €ì¥ì†Œì— Push

ë°°í¬ í›„ í™•ì¸ ì‚¬í•­:

- [ ] ë°°í¬ ë¡œê·¸ í™•ì¸ (ì—ëŸ¬ ì—†ëŠ”ì§€)
- [ ] `/health` ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸
- [ ] `/api/health` ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í™•ì¸
- [ ] ì›¹ í˜ì´ì§€ ì ‘ì† í™•ì¸
- [ ] ë¡œê·¸ì¸ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] ê²Œì‹œíŒ/ê³µì§€/ì¼ì • ì¡°íšŒ í…ŒìŠ¤íŠ¸

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-02-19
